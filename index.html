
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nihar's Text Reader</title>
<style>
  body {
    background-color: #000;  
    color: #b4b4b4;
  }
  #container {
    width: 100%;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
  }
  .page-container {
    margin-bottom: 2px;
  }
  .page {
    width: 96vw;
    height: 200vh;
    border: 2px solid #888;
    border-radius: 6px;
    overflow: auto;
    padding: 2px;
  }
  .page-number {
    text-align: center;
  }
  #fileUploader {
    background-color: #000;
    padding: 6px;
    color: #b4b4b4;
    border: 2px solid #888;
    border-radius: 10px;
    cursor: pointer;
    margin-top: 150%;
  }
  #open {
    background-color: #000;
    padding: 9px;
    color: #b4b4b4;
    border: 2px solid #888;
    border-radius: 10px;
    cursor: pointer;
    margin-top: 150%;
  }
</style>
</head>
<body>
<div id="container">
  <div id="fileInput">
    <input type="file" id="fileUploader" accept=".txt">
    <button id="open" onclick="openFile()">OPEN</button>
  </div>
</div>

<script>

    let textContent = "";
let lastViewedPage = 1; // Variable to store the last viewed page number

function openFile() {
  const fileInput = document.getElementById('fileUploader');
  const file = fileInput.files[0];
  const reader = new FileReader();

  reader.onload = function(event) {
    textContent = event.target.result;
    displayTextPages();
  }

  reader.readAsText(file);
}

function displayTextPages() {
  const textPagesContainer = document.getElementById('container');
  textPagesContainer.innerHTML = '';
  
  const pageSize = 3000;
  const totalPages = Math.ceil(textContent.length / pageSize);

  for (let i = 0; i < totalPages; i++) {
    const start = i * pageSize;
    const end = (i + 1) * pageSize;
    const pageContent = textContent.substring(start, end);
    
    const pageContainer = document.createElement('div');
    pageContainer.classList.add('page-container');
    
    const pageDiv = document.createElement('div');
    pageDiv.classList.add('page');
    pageDiv.textContent = pageContent;
    
    const pageNumber = document.createElement('div');
    pageNumber.classList.add('page-number');
    pageNumber.textContent = `Page - ${i + 1}`;
    
    pageContainer.appendChild(pageDiv);
    pageContainer.appendChild(pageNumber);
    
    textPagesContainer.appendChild(pageContainer);
  }

  // Update last viewed page number
  scrollToPage(lastViewedPage);
}

function scrollToPage(pageNumber) {
  const pages = document.getElementsByClassName('page');
  const targetPage = pages[pageNumber - 1];
  if (targetPage) {
    targetPage.scrollIntoView({ behavior: 'smooth' });
    lastViewedPage = pageNumber; // Update last viewed page number
  }
}

window.onload = function() {
  // Check if there's a cached file and load it
  const cachedText = localStorage.getItem('cachedText');
  const cachedPage = localStorage.getItem('lastViewedPage'); // Retrieve last viewed page number
  if (cachedText) {
    textContent = cachedText;
    lastViewedPage = cachedPage ? parseInt(cachedPage) : 1; // Parse and assign last viewed page number
    displayTextPages();
  }
}

window.onbeforeunload = function() {
  // Cache the text file and last viewed page number
  localStorage.setItem('cachedText', textContent);
  localStorage.setItem('lastViewedPage', lastViewedPage);
}

</script>
</body>
</html>
