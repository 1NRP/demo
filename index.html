<!--
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Play M3U8 Video</title>
</head>
<body>
    <h1>M3U8 Video Player</h1>
    
    <video id="video" controls width="640" height="360">
        Your browser does not support the video tag.
    </video>
    
    <br>
    <button id="playButton">Play Video</button>
    
    <script>
        async function playM3U8Video() {
            try {
                console.log("Fetching the M3U8 content with no referrer...");
                
                // Fetch the M3U8 content with no referrer
                const response = await fetch('https://srbo3gia676hprqy.public.blob.vercel-storage.com/M3U8-HTML/1Afdi7gFzH2E5YuLasX3rNg.m3u8', {
                    referrer: 'no-referrer'
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                console.log("Response received, reading text...");
                
                // Get the text content of the M3U8 file
                const data = await response.text();
                
                console.log("M3U8 content fetched:", data.slice(0, 100), "..."); // Log first 100 chars
                
                // Create a Blob from the M3U8 text content
                const blob = new Blob([data], { type: 'application/vnd.apple.mpegurl' });
                
                // Generate a URL for the Blob
                const blobUrl = URL.createObjectURL(blob);
                
                console.log("Blob URL generated:", blobUrl);
                
                // Set the Blob URL as the video source
                const video = document.getElementById('video');
                
                // Remove any existing sources
                video.innerHTML = '';
                
                const source = document.createElement('source');
                source.src = blobUrl;
                source.type = 'application/vnd.apple.mpegurl';
                
                video.appendChild(source);
                
                // Ensure the video element is ready before calling play
                video.load();
                
                // Use setTimeout to delay playback slightly
                setTimeout(() => {
                    console.log("Starting video playback...");
                    video.play().catch(error => console.error('Error during playback:', error));
                }, 1000); // Adjust timeout as needed
                
            } catch (error) {
                console.error('Error fetching the M3U8 file:', error);
            }
        }

        // Add event listener to the button
        document.getElementById('playButton').addEventListener('click', playM3U8Video);
    </script>
</body>
</html>
-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M3U8 Player</title>
</head>
<body>
    <h1>M3U8 Video Player</h1>
    <input type="text" id="urlInput" placeholder="Enter M3U8 URL" />
    <button id="fetchButton">Fetch M3U8</button>
    
    <video id="videoPlayer" controls style="margin-top: 20px; width: 100%;">
        Your browser does not support the video tag.
    </video>

<script>
        document.getElementById('fetchButton').addEventListener('click', async () => {
    const url = document.getElementById('urlInput').value;

    try {
        const response = await fetch(url, { referrerPolicy: 'no-referrer' });
        if (!response.ok) throw new Error('Network response was not ok');

        let m3u8Text = await response.text();

        // Assuming the M3U8 file contains relative URLs, convert them to absolute URLs
        const baseURL = url.substring(0, url.lastIndexOf("/") + 1);
        m3u8Text = m3u8Text.replace(/(.*\.ts)/g, baseURL + '$1');

        // Create a Blob from the modified M3U8 text
        const blob = new Blob([m3u8Text], { type: 'application/vnd.apple.mpegurl' });
        const blobUrl = URL.createObjectURL(blob);

        // Use HLS.js to play the M3U8
        const videoPlayer = document.getElementById('videoPlayer');

        if (Hls.isSupported()) {
            const hls = new Hls();
            hls.loadSource(blobUrl);
            hls.attachMedia(videoPlayer);
            videoPlayer.play();
        } else if (videoPlayer.canPlayType('application/vnd.apple.mpegurl')) {
            // Fallback for browsers with native HLS support
            videoPlayer.src = blobUrl;
            videoPlayer.play();
        } else {
            alert('Your browser does not support HLS.');
        }
    } catch (error) {
        console.error('Error fetching the M3U8 file:', error);
        alert('Failed to fetch M3U8 file. Please check the URL.');
    }
});

</script>
</body>
</html>
