<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Play M3U8 Video</title>
</head>
<body>
    <h1>M3U8 Video Player</h1>
    
    <!-- Video element -->
    <video id="video" controls width="640" height="360">
        Your browser does not support the video tag.
    </video>
    
    <!-- Button to invoke the function -->
    <br>
    <button id="playButton">Play Video</button>
    
    <script>
        async function playM3U8Video() {
            try {
                console.log("Fetching the M3U8 content with no referrer...");
                
                // Fetch the M3U8 content with no referrer
                const response = await fetch('https://srbo3gia676hprqy.public.blob.vercel-storage.com/M3U8-HTML/1Afdi7gFzH2E5YuLasX3rNg.m3u8', {
                    referrer: 'no-referrer'
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                console.log("Response received, reading text...");
                
                // Get the text content of the M3U8 file
                const data = await response.text();
                
                console.log("M3U8 content fetched:", data.slice(0, 100), "..."); // Log first 100 chars
                
                // Create a Blob from the M3U8 text content
                const blob = new Blob([data], { type: 'application/vnd.apple.mpegurl' });
                
                // Generate a URL for the Blob
                const blobUrl = URL.createObjectURL(blob);
                
                console.log("Blob URL generated:", blobUrl);
                
                // Set the Blob URL as the video source
                const video = document.getElementById('video');
                
                // Remove any existing sources
                video.innerHTML = '';
                
                const source = document.createElement('source');
                source.src = blobUrl;
                source.type = 'application/vnd.apple.mpegurl';
                
                video.appendChild(source);
                
                // Ensure the video element is ready before calling play
                video.load();
                
                // Use setTimeout to delay playback slightly
                setTimeout(() => {
                    console.log("Starting video playback...");
                    video.play().catch(error => console.error('Error during playback:', error));
                }, 1000); // Adjust timeout as needed
                
            } catch (error) {
                console.error('Error fetching the M3U8 file:', error);
            }
        }

        // Add event listener to the button
        document.getElementById('playButton').addEventListener('click', playM3U8Video);
    </script>
</body>
</html>
