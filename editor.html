<!--
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JavaScript Code Editor with Suggestions</title>
    <style>
        .textarea-container {
            position: relative;
            width: 600px;
            margin: 50px auto;
        }
        textarea {
            width: 100%;
            height: 200px;
            font-family: monospace;
            font-size: 16px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box;
        }
        .suggestions {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            background-color: white;
            border: 1px solid #ccc;
            border-top: none;
            max-height: 150px;
            overflow-y: auto;
            z-index: 10;
            width: 100%;
            display: none;
        }
        .suggestion-item {
            padding: 5px;
            cursor: pointer;
        }
        .suggestion-item:hover {
            background-color: #f0f0f0;
        }
        .keyword {
            color: blue;
            font-weight: bold;
        }
        .string {
            color: green;
        }
    </style>
</head>
<body>
    <h2>Real-time JavaScript Syntax Highlighter & Autocomplete</h2>

    <div class="textarea-container">
        <textarea class="js-editor"></textarea>
        <div class="suggestions"></div>
    </div>

    <script>
        const keywords = [
            'break', 'case', 'catch', 'class', 'const', 'continue', 'debugger', 'default', 'delete', 'do',
            'else', 'export', 'extends', 'finally', 'for', 'function', 'if', 'import', 'in', 'instanceof', 'let',
            'new', 'return', 'super', 'switch', 'this', 'throw', 'try', 'typeof', 'var', 'void', 'while', 'with'
        ];

        // Function to highlight JavaScript code and manage variables
        function highlightCode(inputCode, variables) {
            // Match strings and keywords
            const regex = /("(?:[^"\\]|\\.)*"|'(?:[^'\\]|\\.)*'|\/\/[^\n]*|\b(?:${keywords.join('|')})\b|\w+)/g;

            return inputCode.replace(regex, function(match) {
                // Match strings
                if (match.startsWith('"') || match.startsWith("'")) {
                    return `<span class="string">${match}</span>`;
                }
                // Match comments
                if (match.startsWith('//')) {
                    return `<span class="comment">${match}</span>`;
                }
                // Match keywords
                if (keywords.includes(match)) {
                    return `<span class="keyword">${match}</span>`;
                }
                // Match variable (user-defined)
                if (variables.has(match)) {
                    return `<span class="variable">${match}</span>`;
                }
                // Otherwise, just return the match as it is (no highlighting)
                return match;
            });
        }

        // Function to show suggestions
        function showSuggestions(textarea, suggestionsDiv, variables) {
            const text = textarea.value;
            const cursorPos = textarea.selectionStart;
            const startPos = text.lastIndexOf(' ', cursorPos - 1) + 1;
            const word = text.slice(startPos, cursorPos);
            
            if (!word) {
                suggestionsDiv.style.display = 'none';
                return;
            }

            // Find possible keywords and user variables for suggestion
            const possibleSuggestions = new Set([...keywords.filter(k => k.startsWith(word)), ...variables].slice(0, 10));

            // Display suggestions
            suggestionsDiv.innerHTML = '';
            possibleSuggestions.forEach(suggestion => {
                const div = document.createElement('div');
                div.classList.add('suggestion-item');
                div.textContent = suggestion;
                div.onclick = function() {
                    insertSuggestion(textarea, startPos, word, suggestion);
                    suggestionsDiv.style.display = 'none';
                };
                suggestionsDiv.appendChild(div);
            });

            // Show the suggestions div
            suggestionsDiv.style.display = possibleSuggestions.size > 0 ? 'block' : 'none';
        }

        // Function to insert the selected suggestion into the textarea
        function insertSuggestion(textarea, startPos, word, suggestion) {
            const text = textarea.value;
            const newText = text.slice(0, startPos) + suggestion + text.slice(startPos + word.length);
            textarea.value = newText;
            textarea.selectionStart = textarea.selectionEnd = startPos + suggestion.length;
        }

        // Function to update the highlighter and variable list
        function updateEditor() {
            const textarea = document.querySelector('.js-editor');
            const suggestionsDiv = document.querySelector('.suggestions');
            const variables = new Set();

            // Collect variables by finding all non-keyword, non-builtin names
            const text = textarea.value;
            const regex = /\b([a-zA-Z_$][a-zA-Z_$0-9]*)\b/g;
            let match;
            while ((match = regex.exec(text)) !== null) {
                const word = match[1];
                if (!keywords.includes(word)) {
                    variables.add(word);
                }
            }

            // Highlight the code with variables
            const highlightedCode = highlightCode(text, variables);
            textarea.innerHTML = highlightedCode;

            // Show suggestions based on the current word
            showSuggestions(textarea, suggestionsDiv, variables);
        }

        // Event listener for the textarea
        const textarea = document.querySelector('.js-editor');
        const suggestionsDiv = document.querySelector('.suggestions');

        textarea.addEventListener('input', updateEditor);
        textarea.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                suggestionsDiv.style.display = 'none'; // Hide suggestions when Enter is pressed
            }
        });
    </script>
</body>
</html>
-->


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JavaScript Code Editor with Suggestions</title>
    <style>
        .editor-container {
            position: relative;
            width: 600px;
            margin: 50px auto;
        }
        .editor {
            width: 100%;
            height: 200px;
            font-family: monospace;
            font-size: 16px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box;
            white-space: pre-wrap;
            word-wrap: break-word;
            min-height: 150px;
        }
        .suggestions {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            background-color: white;
            border: 1px solid #ccc;
            border-top: none;
            max-height: 150px;
            overflow-y: auto;
            z-index: 10;
            width: 100%;
            display: none;
            box-sizing: border-box;
        }
        .suggestion-item {
            padding: 5px;
            cursor: pointer;
        }
        .suggestion-item:hover {
            background-color: #f0f0f0;
        }
        .keyword {
            color: blue;
            font-weight: bold;
        }
        .string {
            color: green;
        }
        .variable {
            color: purple;
        }
        .comment {
            color: gray;
        }
    </style>
</head>
<body>
    <h2>Real-time JavaScript Syntax Highlighter & Autocomplete</h2>

    <div class="editor-container">
        <div class="editor" contenteditable="true"></div>
        <div class="suggestions"></div>
    </div>

    <script>
        const keywords = [
            'break', 'case', 'catch', 'class', 'const', 'continue', 'debugger', 'default', 'delete', 'do',
            'else', 'export', 'extends', 'finally', 'for', 'function', 'if', 'import', 'in', 'instanceof', 'let',
            'new', 'return', 'super', 'switch', 'this', 'throw', 'try', 'typeof', 'var', 'void', 'while', 'with'
        ];

        // Function to highlight JavaScript code and manage variables
        function highlightCode(inputCode, variables) {
            // Match strings, comments, keywords, and variables
            const regex = /("(?:[^"\\]|\\.)*"|'(?:[^'\\]|\\.)*'|\/\/[^\n]*|\b(?:${keywords.join('|')})\b|\w+)/g;

            return inputCode.replace(regex, function(match) {
                // Match strings
                if (match.startsWith('"') || match.startsWith("'")) {
                    return `<span class="string">${match}</span>`;
                }
                // Match comments
                if (match.startsWith('//')) {
                    return `<span class="comment">${match}</span>`;
                }
                // Match keywords
                if (keywords.includes(match)) {
                    return `<span class="keyword">${match}</span>`;
                }
                // Match variable (user-defined)
                if (variables.has(match)) {
                    return `<span class="variable">${match}</span>`;
                }
                // Otherwise, just return the match as it is (no highlighting)
                return match;
            });
        }

        // Function to show suggestions
        function showSuggestions(editor, suggestionsDiv, variables) {
            const text = editor.textContent;
            const cursorPos = getCaretPosition(editor);
            const startPos = text.lastIndexOf(' ', cursorPos - 1) + 1;
            const word = text.slice(startPos, cursorPos);

            if (!word) {
                suggestionsDiv.style.display = 'none';
                return;
            }

            // Find possible keywords and user variables for suggestion
            const possibleSuggestions = new Set([...keywords.filter(k => k.startsWith(word)), ...variables].slice(0, 10));

            // Display suggestions
            suggestionsDiv.innerHTML = '';
            possibleSuggestions.forEach(suggestion => {
                const div = document.createElement('div');
                div.classList.add('suggestion-item');
                div.textContent = suggestion;
                div.onclick = function() {
                    insertSuggestion(editor, startPos, word, suggestion);
                    suggestionsDiv.style.display = 'none';
                };
                suggestionsDiv.appendChild(div);
            });

            // Show the suggestions div
            suggestionsDiv.style.display = possibleSuggestions.size > 0 ? 'block' : 'none';
        }

        // Function to get the caret position in a contenteditable div
        function getCaretPosition(editor) {
            let caretPos = 0;
            const selection = window.getSelection();
            if (selection.rangeCount) {
                const range = selection.getRangeAt(0);
                const preCaretRange = range.cloneRange();
                preCaretRange.selectNodeContents(editor);
                preCaretRange.setEnd(range.endContainer, range.endOffset);
                caretPos = preCaretRange.toString().length;
            }
            return caretPos;
        }

        // Function to insert the selected suggestion into the editor
        function insertSuggestion(editor, startPos, word, suggestion) {
            const text = editor.textContent;
            const newText = text.slice(0, startPos) + suggestion + text.slice(startPos + word.length);
            editor.textContent = newText;
            placeCaretAt(editor, startPos + suggestion.length);
        }

        // Function to place the caret (cursor) at a specific position in the contenteditable div
        function placeCaretAt(editor, position) {
            const range = document.createRange();
            const sel = window.getSelection();
            range.setStart(editor.firstChild, position);
            range.setEnd(editor.firstChild, position);
            sel.removeAllRanges();
            sel.addRange(range);
        }

        // Function to update the highlighter and variable list
        function updateEditor() {
            const editor = document.querySelector('.editor');
            const suggestionsDiv = document.querySelector('.suggestions');
            const variables = new Set();

            // Collect variables by finding all non-keyword, non-builtin names
            const text = editor.textContent;
            const regex = /\b([a-zA-Z_$][a-zA-Z_$0-9]*)\b/g;
            let match;
            while ((match = regex.exec(text)) !== null) {
                const word = match[1];
                if (!keywords.includes(word)) {
                    variables.add(word);
                }
            }

            // Highlight the code with variables
            const highlightedCode = highlightCode(text, variables);
            editor.innerHTML = highlightedCode;

            // Show suggestions based on the current word
            showSuggestions(editor, suggestionsDiv, variables);
        }

        // Event listener for the contenteditable div
        const editor = document.querySelector('.editor');
        const suggestionsDiv = document.querySelector('.suggestions');

        editor.addEventListener('input', updateEditor);
        editor.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                suggestionsDiv.style.display = 'none'; // Hide suggestions when Enter is pressed
            }
        });
    </script>
</body>
</html>

